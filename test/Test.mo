import M "mo:matchers/Matchers";
import S "mo:matchers/Suite";
import T "mo:matchers/Testable";
import SHA224 "../src/SHA224";
import Debug "mo:base/Debug";
import Array "mo:base/Array";
import Nat8 "mo:base/Nat8";

type Test = {
  data : [Nat8];
  expect : [Nat8];
};

let ParamsInit = S.suite("ParamsInit", do {
  Debug.print("ParamsInit");
  var tests : [S.Suite] = [];

  let testsDatas = [
    {
      data = [
      ] : [Nat8];
      expect = [
        209, 74, 2, 140, 42, 58, 43, 
        201, 71, 97, 2, 187, 40, 130, 
        52, 196, 21, 162, 176, 31, 130, 
        142, 166, 42, 197, 179, 228, 47,
      ] : [Nat8];
    },
    {
      data = [
        097,
      ] : [Nat8];
      expect = [
        171, 211, 117, 52, 199, 217, 162, 
        239, 185, 70, 93, 233, 49, 205, 
        112, 85, 255, 219, 136, 121, 86, 
        58, 233, 128, 120, 214, 214, 213,
      ] : [Nat8];
    },
    {
      data = [
        097, 098,
      ] : [Nat8];
      expect = [
        219, 60, 218, 134, 212, 66, 154,
        29, 57, 193, 72, 152, 149, 102,
        179, 143, 123, 218, 1, 86, 41,
        107, 211, 100, 186, 47, 135, 139,
      ] : [Nat8];
    },
    {
      data = [
        097, 098, 099,
      ] : [Nat8];
      expect = [
        35, 9, 125, 34, 52, 5, 216,
        34, 134, 66, 164, 119, 189, 162,
        85, 179, 42, 173, 188, 228, 189,
        160, 179, 247, 227, 108, 157, 167,
      ] : [Nat8];
    },
    {
      data = [
        097, 098, 099, 100,
      ] : [Nat8];
      expect = [
        167, 102, 84, 216, 227, 85, 14,
        154, 45, 103, 160, 238, 182, 198,
        123, 34, 14, 88, 133, 237, 221,
        63, 222, 19, 88, 6, 230, 1,
      ] : [Nat8];
    },
    {
      data = [
        097, 098, 099, 100, 101,
      ] : [Nat8];
      expect = [
        189, 208, 61, 86, 9, 147, 230,
        117, 81, 107, 165, 165, 6, 56,
        182, 83, 26, 194, 172, 61, 88,
        71, 198, 25, 22, 207, 206, 214,
      ] : [Nat8];
    },
    {
      data = [
        097, 098, 099, 100, 101, 102,
      ] : [Nat8];
      expect = [
        112, 67, 99, 28, 180, 21, 85,
        106, 39, 90, 78, 190, 203, 128,
        44, 116, 238, 159, 97, 83, 144,
        142, 23, 146, 169, 11, 106, 152,
      ] : [Nat8];
    },
    {
      data = [
        097, 098, 099, 100, 101, 102, 103,
      ] : [Nat8];
      expect = [
        209, 136, 78, 113, 23, 1, 173,
        129, 171, 224, 199, 122, 59, 14,
        161, 46, 25, 186, 154, 246, 64,
        119, 40, 108, 114, 252, 96, 45,
      ] : [Nat8];
    },
    {
      data = [
        097, 098, 099, 100, 101, 102, 103, 104,
      ] : [Nat8];
      expect = [
        23, 235, 125, 64, 240, 53, 111,
        133, 152, 232, 158, 175, 173, 95,
        108, 117, 155, 31, 130, 41, 117,
        217, 201, 183, 55, 200, 165, 23,
      ] : [Nat8];
    },
    {
      data = [
        097, 098, 099, 100, 101, 102, 103, 104,
        105,
      ] : [Nat8];
      expect = [
        174, 179, 89, 21, 52, 108, 88,
        77, 184, 32, 210, 222, 122, 243,
        146, 159, 250, 254, 249, 34, 42,
        155, 203, 38, 81, 108, 115, 52,
      ] : [Nat8];
    },
    {
      data = [
        097, 098, 099, 100, 101, 102, 103, 104,
        105, 106,
      ] : [Nat8];
      expect = [
        211, 94, 30, 90, 242, 157, 219,
        13, 126, 21, 67, 87, 223, 74,
        217, 132, 42, 254, 229, 39, 198,
        137, 238, 84, 127, 117, 49, 136,
      ] : [Nat8];
    },
    {
      data = [
        068, 105, 115, 099, 097, 114, 100, 032,
        109, 101, 100, 105, 099, 105, 110, 101,
        032, 109, 111, 114, 101, 032, 116, 104,
        097, 110, 032, 116, 119, 111, 032, 121,
        101, 097, 114, 115, 032, 111, 108, 100,
        046,
      ] : [Nat8];
      expect = [
        25, 41, 127, 28, 239, 125, 220,
        138, 126, 148, 127, 92, 90, 52,
        30, 16, 247, 36, 80, 69, 228,
        37, 219, 103, 4, 57, 136, 215,
      ] : [Nat8];
    },
    {
      data = [
        072, 101, 032, 119, 104, 111, 032, 104,
        097, 115, 032, 097, 032, 115, 104, 097,
        100, 121, 032, 112, 097, 115, 116, 032,
        107, 110, 111, 119, 115, 032, 116, 104,
        097, 116, 032, 110, 105, 099, 101, 032,
        103, 117, 121, 115, 032, 102, 105, 110,
        105, 115, 104, 032, 108, 097, 115, 116,
        046,
      ] : [Nat8];
      expect = [
        15, 16, 194, 235, 67, 98, 81,
        247, 119, 251, 189, 18, 94, 38,
        13, 54, 174, 207, 24, 4, 17,
        114, 108, 124, 136, 95, 89, 154,
      ] : [Nat8];
    },
    {
      data = [
        073, 032, 119, 111, 117, 108, 100, 110,
        039, 116, 032, 109, 097, 114, 114, 121,
        032, 104, 105, 109, 032, 119, 105, 116,
        104, 032, 097, 032, 116, 101, 110, 032,
        102, 111, 111, 116, 032, 112, 111, 108,
        101, 046,
      ] : [Nat8];
      expect = [
        77, 24, 66, 16, 73, 25, 243,
        20, 202, 216, 163, 205, 32, 179,
        203, 167, 232, 237, 62, 122, 190,
        214, 43, 87, 68, 19, 88, 246,
      ] : [Nat8];
    },
    {
      data = [
        070, 114, 101, 101, 033, 032, 070, 114,
        101, 101, 033, 047, 065, 032, 116, 114,
        105, 112, 047, 116, 111, 032, 077, 097,
        114, 115, 047, 102, 111, 114, 032, 057,
        048, 048, 047, 101, 109, 112, 116, 121,
        032, 106, 097, 114, 115, 047, 066, 117,
        114, 109, 097, 032, 083, 104, 097, 118,
        101,
      ] : [Nat8];
      expect = [
        168, 186, 133, 198, 254, 12, 72,
        251, 255, 199, 43, 187, 47, 3,
        252, 219, 200, 122, 226, 220, 122,
        86, 128, 77, 21, 144, 251, 59,
      ] : [Nat8];
    },
    {
      data = [
        084, 104, 101, 032, 100, 097, 121, 115,
        032, 111, 102, 032, 116, 104, 101, 032,
        100, 105, 103, 105, 116, 097, 108, 032,
        119, 097, 116, 099, 104, 032, 097, 114,
        101, 032, 110, 117, 109, 098, 101, 114,
        101, 100, 046, 032, 032, 045, 084, 111,
        109, 032, 083, 116, 111, 112, 112, 097,
        114, 100,
      ] : [Nat8];
      expect = [
        85, 67, 251, 171, 38, 230, 126,
        136, 133, 177, 168, 82, 213, 103,
        209, 203, 139, 155, 254, 66, 224,
        137, 149, 132, 197, 4, 73, 169,
      ] : [Nat8];
    },
    {
      data = [
        078, 101, 112, 097, 108, 032, 112, 114,
        101, 109, 105, 101, 114, 032, 119, 111,
        110, 039, 116, 032, 114, 101, 115, 105,
        103, 110, 046,
      ] : [Nat8];
      expect = [
        101, 202, 16, 115, 144, 245, 218,
        158, 250, 5, 210, 142, 87, 178,
        33, 101, 126, 220, 126, 67, 169,
        161, 143, 177, 91, 5, 61, 219,
      ] : [Nat8];
    },
    {
      data = [
        070, 111, 114, 032, 101, 118, 101, 114,
        121, 032, 097, 099, 116, 105, 111, 110,
        032, 116, 104, 101, 114, 101, 032, 105,
        115, 032, 097, 110, 032, 101, 113, 117,
        097, 108, 032, 097, 110, 100, 032, 111,
        112, 112, 111, 115, 105, 116, 101, 032,
        103, 111, 118, 101, 114, 110, 109, 101,
        110, 116, 032, 112, 114, 111, 103, 114,
        097, 109, 046,
      ] : [Nat8];
      expect = [
        132, 149, 57, 98, 190, 54, 99,
        5, 169, 204, 155, 92, 209, 110,
        208, 25, 237, 195, 122, 201, 108,
        13, 235, 62, 18, 204, 161, 22,
      ] : [Nat8];
    },
  ];

  let data : [Nat8] = [
      072, 105, 115, 032, 109, 111, 110, 101,
      121, 032, 105, 115, 032, 116, 119, 105,
      099, 101, 032, 116, 097, 105, 110, 116,
      101, 100, 058, 032, 039, 116, 097, 105,
      110, 116, 032, 121, 111, 117, 114, 115,
      032, 097, 110, 100, 032, 039, 116, 097,
      105, 110, 116, 032, 109, 105, 110, 101,
      046,
    ];
  let expect : [Nat8] = [
      53, 161, 137, 206, 152, 113, 81, 
      223, 208, 11, 53, 119, 88, 60, 
      198, 167, 75, 152, 105, 238, 207, 
      137, 68, 89, 203, 82, 3, 141,
    ];
  for (testsData in testsDatas.vals()) {
    tests := Array.append(tests, [S.test("ok", Array.equal(testsData.expect, SHA224.sha224(testsData.data), Nat8.equal), M.equals(T.bool(true)))]);
  };
  tests
});

let suite = S.suite("sha", [
  ParamsInit
]);

S.run(suite);
